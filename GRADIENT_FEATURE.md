# ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³éæ¿€åŒ–æ©Ÿèƒ½ - æŠ€è¡“èª¬æ˜æ›¸

DasaMakerã«è¿½åŠ ã•ã‚ŒãŸã€Œã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³éæ¿€åŒ–æ©Ÿèƒ½ã€ã®å®Ÿè£…è©³ç´°ã§ã™ã€‚

## æ¦‚è¦

ãƒ¬ãƒ™ãƒ«5ä»¥ä¸Šã®ã¨ãã«ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚·ã‚§ã‚¤ãƒ—ï¼ˆå›³å½¢ï¼‰ã«å¯¾ã—ã¦ãƒã‚ªãƒ³è‰²ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é©ç”¨ã—ã¾ã™ã€‚

## æ©Ÿèƒ½ä»•æ§˜

### ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨ãƒ¬ãƒ™ãƒ«

| ãƒ€ã‚µã•ãƒ¬ãƒ™ãƒ« | ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ç¨®é¡ | è‰²æ•° | ç‰¹å¾´ |
|-----------|-----------------|------|------|
| 1-4 | ãªã— | - | ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æœªé©ç”¨ |
| 5-6 | **ã‚·ãƒ³ãƒ—ãƒ«ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³** | 2è‰² | 2ã¤ã®ãƒã‚ªãƒ³è‰²ã®å˜ç´”ãªã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| 7-8 | **ãƒãƒ«ãƒã‚«ãƒ©ãƒ¼ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³** | 3-4è‰² | è¤‡æ•°ã®ãƒã‚ªãƒ³è‰²ã‚’ä½¿ç”¨ã—ãŸæ®µéšçš„ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| 9-10 | **æ¥µåº¦ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³** | æœ€å¤§8è‰² | ã™ã¹ã¦ã®ãƒã‚ªãƒ³ã‚«ãƒ©ãƒ¼ã‚’ä½¿ç”¨ã—ãŸè¶…æ´¾æ‰‹ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |

### ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è§’åº¦

å„ãƒ¬ãƒ™ãƒ«ã§ãƒ©ãƒ³ãƒ€ãƒ ã«ä»¥ä¸‹ã®è§’åº¦ã‹ã‚‰é¸æŠï¼š

```python
[0Â°, 45Â°, 90Â°, 135Â°, 180Â°, 225Â°, 270Â°, 315Â°]
```

ã“ã‚Œã«ã‚ˆã‚Šã€åŒã˜ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚‚æ¯å›ç•°ãªã‚‹ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ–¹å‘ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚

### ãƒã‚ªãƒ³ã‚«ãƒ©ãƒ¼ãƒšã‚¢ï¼ˆãƒ¬ãƒ™ãƒ«5-6ï¼‰

```python
EXTREME_NEON_PAIRS = [
    [(255, 0, 127), (0, 255, 255)],      # ãƒ›ãƒƒãƒˆãƒ”ãƒ³ã‚¯ â†’ ã‚·ã‚¢ãƒ³
    [(255, 255, 0), (255, 0, 0)],        # é»„è‰² â†’ èµ¤
    [(0, 255, 0), (148, 0, 211)],        # ãƒ©ã‚¤ãƒ ã‚°ãƒªãƒ¼ãƒ³ â†’ é’ç´«
    [(255, 127, 0), (255, 0, 127)],      # ã‚ªãƒ¬ãƒ³ã‚¸ â†’ ãƒ›ãƒƒãƒˆãƒ”ãƒ³ã‚¯
    # ... è¨ˆ10ãƒšã‚¢
]
```

## å®Ÿè£…è©³ç´°

### ã‚¯ãƒ©ã‚¹æ§‹æˆ

```python
class TacoGenerator:
    def _apply_extreme_gradient(self, shape) -> None
        â†“
    â”œâ”€ _apply_simple_gradient(fill)          # ãƒ¬ãƒ™ãƒ«5-6
    â”œâ”€ _apply_multi_color_gradient(fill)     # ãƒ¬ãƒ™ãƒ«7-8
    â””â”€ _apply_extreme_multi_gradient(fill)   # ãƒ¬ãƒ™ãƒ«9-10
```

### ãƒ¡ã‚½ãƒƒãƒ‰èª¬æ˜

#### `_apply_extreme_gradient()`

ãƒ¡ã‚¤ãƒ³ã®åˆ¶å¾¡ãƒ¡ã‚½ãƒƒãƒ‰ã€‚ãƒ€ã‚µã•ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦é©åˆ‡ãªã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ–¹æ³•ã‚’é¸æŠã€‚

```python
def _apply_extreme_gradient(self, shape) -> None:
    """Apply extreme gradient fills to shapes with leveled intensity"""
    if self.tacky_level in [5, 6]:
        self._apply_simple_gradient(fill)
    elif self.tacky_level in [7, 8]:
        self._apply_multi_color_gradient(fill)
    elif self.tacky_level >= 9:
        self._apply_extreme_multi_gradient(fill)
```

#### `_apply_simple_gradient()`

**ãƒ¬ãƒ™ãƒ«5-6**: ã‚·ãƒ³ãƒ—ãƒ«ãª2è‰²ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```python
def _apply_simple_gradient(self, fill) -> None:
    fill.gradient()
    fill.gradient_angle = random_angle  # 0-315åº¦
    color_pair = random_choice(EXTREME_NEON_PAIRS)
    fill.gradient_stops[0].color.rgb = RGBColor(*color_pair[0])
    fill.gradient_stops[1].color.rgb = RGBColor(*color_pair[1])
```

**å‡ºåŠ›ä¾‹:**
- ãƒ›ãƒƒãƒˆãƒ”ãƒ³ã‚¯ â†’ ã‚·ã‚¢ãƒ³
- é»„è‰² â†’ èµ¤
- etc.

#### `_apply_multi_color_gradient()`

**ãƒ¬ãƒ™ãƒ«7-8**: 3-4è‰²ã®ãƒãƒ«ãƒã‚«ãƒ©ãƒ¼ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```python
def _apply_multi_color_gradient(self, fill) -> None:
    fill.gradient()
    num_colors = random_choice([3, 4])
    colors = random_sample(NEON_COLORS, num_colors)
    
    # æœ€åˆã¨æœ€å¾Œã®è‰²ã‚’è¨­å®š
    fill.gradient_stops[0].color.rgb = RGBColor(*colors[0])
    fill.gradient_stops[1].color.rgb = RGBColor(*colors[-1])
    
    # ä¸­é–“è‰²ã‚’è¿½åŠ 
    for i in range(1, len(colors) - 1):
        position = i / (len(colors) - 1)
        new_stop = fill.gradient_stops._insert_stop(position)
        new_stop.color.rgb = RGBColor(*colors[i])
```

**åŠ¹æœ:**
- è¤‡æ•°ã®è‰²ãŒæ®µéšçš„ã«é·ç§»
- ã‚ˆã‚Šè¤‡é›‘ã§æ´¾æ‰‹ãªè¦‹ãŸç›®

#### `_apply_extreme_multi_gradient()`

**ãƒ¬ãƒ™ãƒ«9-10**: æœ€å¤§8è‰²ã®æ¥µåº¦ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```python
def _apply_extreme_multi_gradient(self, fill) -> None:
    fill.gradient()
    colors = NEON_COLORS.copy()
    random.shuffle(colors)
    
    # ã™ã¹ã¦ã®ãƒã‚ªãƒ³ã‚«ãƒ©ãƒ¼ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦ä½¿ç”¨
    for i in range(len(colors)):
        fill.gradient_stops[i].color.rgb = RGBColor(*colors[i])
```

**åŠ¹æœ:**
- æœ€å¤§8ã¤ã®ãƒã‚ªãƒ³è‰²ãŒã™ã¹ã¦ä½¿ç”¨ã•ã‚Œã‚‹
- ãƒ¬ãƒ™ãƒ«10ã§ã¯è§’åº¦ã‚‚ãƒ©ãƒ³ãƒ€ãƒ åŒ–ï¼ˆ0-360åº¦ï¼‰

## å¯¾å¿œã‚·ã‚§ã‚¤ãƒ—ã‚¿ã‚¤ãƒ—

ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒé©ç”¨ã•ã‚Œã‚‹ã‚·ã‚§ã‚¤ãƒ—ï¼š

- âœ… çŸ©å½¢ï¼ˆRectangleï¼‰
- âœ… å††ï¼ˆOvalï¼‰
- âœ… å¤šè§’å½¢ï¼ˆPolygonï¼‰
- âœ… ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ï¼ˆTextBox with fillï¼‰
- âœ… SmartArtï¼ˆå¯èƒ½ãªç¯„å›²ã§ï¼‰

å¯¾å¿œ**ã•ã‚Œãªã„**ã‚·ã‚§ã‚¤ãƒ—ï¼š

- âŒ ç”»åƒï¼ˆPICTUREï¼‰
- âŒ æ—¢ã«ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨æ¸ˆã¿ï¼ˆä¸Šæ›¸ãï¼‰
- âŒ é€æ˜ãƒ•ã‚£ãƒ«

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

å„ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨ãƒ¡ã‚½ãƒƒãƒ‰ã¯`try-except`ã§ä¿è­·ã•ã‚Œã¦ãŠã‚Šã€å¤±æ•—ã—ã¦ã‚‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè½ã¡ã¾ã›ã‚“ã€‚

```python
try:
    fill.gradient()
    # ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
except Exception as e:
    logger.debug(f"Could not apply gradient: {e}")
    # å¤±æ•—ã—ã¦ã‚‚ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ç¶šè¡Œ
```

## ãƒ†ã‚¹ãƒˆ

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

```bash
# ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
pytest tests/test_modules.py::TestTacoGenerator::test_taco_generator_gradient_level_5
pytest tests/test_modules.py::TestTacoGenerator::test_taco_generator_gradient_level_7
pytest tests/test_modules.py::TestTacoGenerator::test_taco_generator_gradient_level_10
```

### çµ±åˆãƒ†ã‚¹ãƒˆ

```bash
# å®Ÿéš›ã®PPTãƒ•ã‚¡ã‚¤ãƒ«ã§å‹•ä½œç¢ºèª
python -c "
from src.taco_generator import TacoGenerator
from pptx import Presentation

prs = Presentation('samples/sample.pptx')
gen = TacoGenerator(prs, tacky_level=10)
gen.apply_tacky_design()
prs.save('output_gradient.pptx')
"
```

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### å‡¦ç†æ™‚é–“

| ãƒ¬ãƒ™ãƒ« | å¹³å‡å‡¦ç†æ™‚é–“ | ç‰¹å¾´ |
|--------|-----------|------|
| 5-6 | < 100ms | é«˜é€Ÿï¼ˆ2è‰²ã®ã¿ï¼‰ |
| 7-8 | 100-200ms | ä¸­ç¨‹åº¦ï¼ˆè¤‡æ•°è‰²è¿½åŠ ï¼‰ |
| 9-10 | 200-400ms | ã‚„ã‚„é…ã„ï¼ˆå…¨è‰²ä½¿ç”¨ï¼‰ |

â€» ã‚¹ãƒ©ã‚¤ãƒ‰æ•°ã€ã‚·ã‚§ã‚¤ãƒ—æ•°ã«ã‚ˆã‚Šå¤‰å‹•

### ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡

- ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æƒ…å ±: ã‚·ã‚§ã‚¤ãƒ—ã‚ãŸã‚Šæ•°KB
- å¤§è¦æ¨¡ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ1000+ã‚¹ãƒ©ã‚¤ãƒ‰ï¼‰ã§ã‚‚å®‰å…¨

## æ—¢çŸ¥ã®åˆ¶é™

### python-pptxã®åˆ¶é™

1. **ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åœæ­¢æ•°ã®åˆ¶é™**
   - ç†è«–ä¸Šã¯ç„¡åˆ¶é™ã ãŒã€Officeå´ã§8è‰²ç¨‹åº¦ã¾ã§å®‰å®š
   - ãƒ¬ãƒ™ãƒ«9-10ã§ã‚‚8è‰²ã«åˆ¶é™

2. **ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ–¹å‘ã®é™å®š**
   - 45åº¦å˜ä½ãŒå®‰å®šï¼ˆ0, 45, 90, 135...ï¼‰
   - ä»»æ„ã®åº¦æ•°ã¯Officeã§æ­£è¦åŒ–ã•ã‚Œã‚‹å¯èƒ½æ€§

3. **æ—¢å­˜ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä¸Šæ›¸ã**
   - æ—¢ã«ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨æ¸ˆã¿ã®ã‚·ã‚§ã‚¤ãƒ—ã¯ä¸Šæ›¸ãã•ã‚Œã‚‹

## ä»Šå¾Œã®æ”¹å–„æ¡ˆ

- [ ] ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åœæ­¢æ•°ã®æŸ”è»Ÿãªåˆ¶å¾¡
- [ ] ãƒ©ã‚¸ã‚¢ãƒ«ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ”¾å°„çŠ¶ï¼‰ã®ã‚µãƒãƒ¼ãƒˆ
- [ ] ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ”ãƒ¼ãƒ‰ã®æ®µéšçš„ãªåŠ é€Ÿ
- [ ] ãƒ†ã‚¯ã‚¹ãƒãƒ£ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®è¿½åŠ 
- [ ] ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ±åˆ

## å‚è€ƒè³‡æ–™

- [python-pptx Documentation - Shapes](https://python-pptx.readthedocs.io/en/latest/api/shapes.html)
- [OOXML ä»•æ§˜ - Gradient Fill](http://officeopenxml.com/drwgGradFill.html)

---

**ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³éæ¿€åŒ–ã§ã€ã‚ãªãŸã®ãƒ—ãƒ¬ã‚¼ãƒ³ã¯æœ€é«˜ã«ãƒ€ã‚µããªã‚‹ï¼ğŸŒˆâœ¨**
